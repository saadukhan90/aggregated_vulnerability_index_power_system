clc
clear
close all

% data for PI and FRI 
PI = [0.212203649
0.288038799
0.708842063
0.29945922
0
0.069595922
0.17906456
0.256684725
0.066069297
0.035467555
0.39270404
0.16638005
0.539703573
NaN
1
0.041694438
0.111320244
0.172074887
0.045102692
0.210147627
]; 

FRI = [0.005649236
0.156413279
0.122339445
0.095287202
0.093148244
0.089770958
0
0.136424605
1
0.200895205
0.123649278
0.207747457
0.049366993
0.095496006
0.033708191
0.017599402
0.232870045
0.114323958
0.124845412
0.393092873
]; 

n = length(PI); % Number of transmission lines

% Handle NaN values by assigning them the highest rank (rank 1)
PI(isnan(PI)) = 1;
FRI(isnan(FRI)) = 1;

% Calculate rankings based on PI and FRI values
[~, PI_ranking] = sort(PI, 'descend');
[~, FRI_ranking] = sort(FRI, 'descend');

% Initialize Borda scores
Borda_scores_PI = zeros(1, n);
Borda_scores_FRI = zeros(1, n);

% Calculate Borda scores for PI and FRI rankings
for i = 1:n
    Borda_scores_PI(PI_ranking(i)) = n - i;
    Borda_scores_FRI(FRI_ranking(i)) = n - i;
end

% Aggregate Borda scores
Aggregated_Borda_scores = Borda_scores_PI + Borda_scores_FRI;

% Sort the transmission lines based on aggregated Borda scores
[~, Aggregated_ranking] = sort(Aggregated_Borda_scores, 'descend');


% Display results
disp('Transmission Line Rankings based on Aggregated Borda Scores:');
disp(Aggregated_ranking);

