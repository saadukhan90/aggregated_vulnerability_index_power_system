clc
clear
close all

% data for PI and FRI 
PI = [0.212203649
0.288038799
0.708842063
0.29945922
0
0.069595922
0.17906456
0.256684725
0.066069297
0.035467555
0.39270404
0.16638005
0.539703573
NaN
1
0.041694438
0.111320244
0.172074887
0.045102692
0.210147627
]; 

FRI = [0.005649236
0.156413279
0.122339445
0.095287202
0.093148244
0.089770958
0
0.136424605
1
0.200895205
0.123649278
0.207747457
0.049366993
0.095496006
0.033708191
0.017599402
0.232870045
0.114323958
0.124845412
0.393092873
]; 

n = length(PI); % Number of transmission lines

% Handle NaN values by assigning them the highest rank (rank 1)
PI(isnan(PI)) = 1;
FRI(isnan(FRI)) = 1;

% Calculate rankings based on PI and FRI values
[~, PI_ranking] = sort(PI, 'descend');
[~, FRI_ranking] = sort(FRI, 'descend');

% Initialize Borda scores
Borda_scores_PI = zeros(1, n);
Borda_scores_FRI = zeros(1, n);

% Calculate Borda scores for PI and FRI rankings
for i = 1:n
    Borda_scores_PI(PI_ranking(i)) = n - i;
    Borda_scores_FRI(FRI_ranking(i)) = n - i;
end

% Aggregate Borda scores
Aggregated_Borda_scores = Borda_scores_PI + Borda_scores_FRI;

% Sort the transmission lines based on aggregated Borda scores
[~, Aggregated_ranking] = sort(Aggregated_Borda_scores, 'descend');

% Prepare data for grouped bar plot
groupedData = [Aggregated_Borda_scores(Aggregated_ranking); Borda_scores_PI(Aggregated_ranking); Borda_scores_FRI(Aggregated_ranking)]';

lines = {'L{13,14}', 'L{2,3}', 'L{7,8}', 'L{6,11}', 'L{4,7}', 'L{9,14}', ...
         'L{4,9}', 'L{10,11}', 'L{1,5}', 'L{6,12}', 'L{7,9}', 'L{6,13}', ...
         'L{5,6}', 'L{2,4}', 'L{12,13}', 'L{1,2}', 'L{3,4}', 'L{4,5}', ...
         'L{2,5}', 'L{9,10}'};

% Plotting the results

fig = figure;
fig.MenuBar = 'none'; % Remove the menu bar
fig.ToolBar = 'none'; % Remove the toolbar

bar(groupedData, 'grouped');

% Add legend
legend('Aggregated Borda Score', 'PI Borda Score', 'FRI Borda Score', 'FontSize', 18);

% Add labels
xlabel('Line');
ylabel('Borda Scores');
%title('Transmission Line Rankings using Borda Count Method');

% Display sorted transmission line indices
% set(gca, 'XTick', 1:n, 'XTickLabel', Aggregated_ranking);
% xtickangle(45);

% Set the x-axis tick labels in the correct order and increase font size
ax = gca;
ax.XTick = 1:length(lines);
ax.XTickLabel = lines;
ax.XAxis.FontSize = 18; % Increase the font size for the x-axis
ax.YAxis.FontSize = 18; % Increase the font size for the y-axis
%ax.TickLength = [0 0]; % Remove tick marks
xtickangle(90); % Rotate x-axis labels for better visibility

% Adjust the figure size to accommodate the stretched plot
fig = gcf;
fig.Position = [100, 100, 1200, 600]; % Modify the size of the figure as desired, last two are size aspect related

% Show the grid
grid on;

% Specify the directory and file name
directory = 'C:\Users\Saad Ullah Khan\Downloads\MSEE_Sajid\Paper\Sajid-Paper-V4\Figures\'; % Replace with your desired directory
filename = 'IEEE14_BCS_ranking_MatP.png';

% Save the figure as a PNG image
%saveas(gcf, fullfile(directory, filename));

exportgraphics(fig, fullfile(directory, filename), 'Resolution', 300);


% Display results
disp('Transmission Line Rankings based on Aggregated Borda Scores:');
disp(Aggregated_ranking);

