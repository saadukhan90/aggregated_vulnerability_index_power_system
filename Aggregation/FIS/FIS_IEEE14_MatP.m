clc
clear 
close all


% data for PI and FRI 
PI = [0.212203649
0.288038799
0.708842063
0.29945922
0
0.069595922
0.17906456
0.256684725
0.066069297
0.035467555
0.39270404
0.16638005
0.539703573
NaN
1
0.041694438
0.111320244
0.172074887
0.045102692
0.210147627
]; 

FRI = [0.005649236
0.156413279
0.122339445
0.095287202
0.093148244
0.089770958
0
0.136424605
1
0.200895205
0.123649278
0.207747457
0.049366993
0.095496006
0.033708191
0.017599402
0.232870045
0.114323958
0.124845412
0.393092873
]; 

n = length(PI); % Number of transmission lines

% Handle NaN values by assigning them the highest rank (rank 1)
PI(isnan(PI)) = 1;
FRI(isnan(FRI)) = 1;

inputData = [PI, FRI];


% Load the FIS
fis = readfis('dist_tri_Alvarez_3x5.fis');

% Evaluate the FIS
AVI_FIS = evalfis(fis, inputData);

% Display the output
disp(AVI_FIS);

% Sort the transmission lines based on aggregated Fuzzy scores
[~, AVI_FIS_ranking] = sort(AVI_FIS, 'descend');


disp(AVI_FIS_ranking);


% Plot
%%-------------------------------------------------------------------------------------------------

% Assuming AVI_FIS and AVI_FIS_ranking are already calculated

% Define the line names
line_name = {'L{1,2}', 'L{1,5}', 'L{2,3}', 'L{2,4}', 'L{2,5}', 'L{3,4}', 'L{4,5}', ...
             'L{4,7}', 'L{4,9}', 'L{5,6}', 'L{6,11}', 'L{6,12}', 'L{6,13}', 'L{7,8}', ...
             'L{7,9}', 'L{9,10}', 'L{9,14}', 'L{10,11}', 'L{12,13}', 'L{13,14}'};

% Sort AVI_FIS values based on the ranking
sorted_AVI_FIS = AVI_FIS(AVI_FIS_ranking);

% Get the sorted line names based on the ranking
sorted_line_names = line_name(AVI_FIS_ranking);

% Create a bar plot

% Plotting the results

fig = figure;
fig.MenuBar = 'none'; % Remove the menu bar
fig.ToolBar = 'none'; % Remove the toolbar


bar_handle = bar(sorted_AVI_FIS);
bar_handle.BarWidth = 0.5;

% Customize the plot
%title('Fuzzy Inference System Evaluation Scores', 'FontSize', 14);
xlabel('Line', 'FontSize', 18);
ylabel('AVI', 'FontSize', 18);

% Set the x-axis tick labels to show the sorted line names
ax = gca;
ax.XTick = 1:length(sorted_line_names);
ax.XTickLabel = sorted_line_names;
ax.XAxis.FontSize = 18; % Increase the font size for the x-axis
ax.YAxis.FontSize = 18; % Increase the font size for the y-axis
xtickangle(90); % Rotate x-axis labels for better visibility

% Adjust the figure size to accommodate the stretched plot
fig = gcf;
fig.Position = [100, 100, 1200, 600]; % Modify the size of the figure as desired, last two are size aspect related

% Show the grid
grid on;

% Specify the directory and file name
directory = 'C:\Users\Saad Ullah Khan\Downloads\MSEE_Sajid\Paper\Sajid-Paper-V4\Figures\'; % Replace with your desired directory
filename = 'IEEE14_FIS_ranking_MatP.png';

% Save the figure as a PNG image
saveas(gcf, fullfile(directory, filename));

exportgraphics(fig, fullfile(directory, filename), 'Resolution', 300);


