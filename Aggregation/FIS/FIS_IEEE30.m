clc
clear 
close all


% data for PI and FRI 
PI = [0.041665344
0.046951031
0.025421744
0.049991205
0.254145853
0.047849684
0.013385243
0.003954384
0.073563587
0.009352485
0
0.037613689
NaN
0.306579356
0.060344154
NaN
0.041318551
0.149934041
0.069367965
0.013225056
0.032853723
0.055053866
0.02180104
0.025476087
0.061469844
0.011206057
0.062239717
0.024195319
0.008084319
0.070773553
0.030465431
0.02537678
0.005396731
NaN
0.055023869
1
0.068754284
0.067844642
0.015482392
0.024553386
0.03119325
]; 

FRI = [0.007565342
0.073514312
0.082089491
0.002417135
0.106824857
0.083978249
0.003170814
0.035543882
0.017051566
0.003302663
0.11747078
0.849382025
0.117940602
0.031821936
0.178663775
0.052651999
0.179643942
0.045145223
0.107784352
0.108876383
0.100431419
0.130865329
0.044562837
0.011254709
0.118935584
0.018146003
0.013989877
0.060739843
0
0.111112616
0.087009829
0.199674581
0.299244989
0.394858263
0.119043985
0.429684717
0.476455625
1
0.565680741
0.109009345
0.008377542
]; 

n = length(PI); % Number of transmission lines

% Handle NaN values by assigning them the highest rank (rank 1)
PI(isnan(PI)) = 1;
FRI(isnan(FRI)) = 1;

inputData = [PI, FRI];


% Load the FIS
fis = readfis('dist_tri_Alvarez_3x5_v2.fis');

% Evaluate the FIS
AVI_FIS = evalfis(fis, inputData);

% Display the output
disp(AVI_FIS);

% Sort the transmission lines based on aggregated Fuzzy scores
[~, AVI_FIS_ranking] = sort(AVI_FIS, 'descend');


disp(AVI_FIS_ranking);





