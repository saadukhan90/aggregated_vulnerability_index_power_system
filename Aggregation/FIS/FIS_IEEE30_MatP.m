clc
clear 
close all


% data for PI and FRI 
PI = [0.041665344
0.046951031
0.025421744
0.049991205
0.254145853
0.047849684
0.013385243
0.003954384
0.073563587
0.009352485
0
0.037613689
NaN
0.306579356
0.060344154
NaN
0.041318551
0.149934041
0.069367965
0.013225056
0.032853723
0.055053866
0.02180104
0.025476087
0.061469844
0.011206057
0.062239717
0.024195319
0.008084319
0.070773553
0.030465431
0.02537678
0.005396731
NaN
0.055023869
1
0.068754284
0.067844642
0.015482392
0.024553386
0.03119325
]; 

FRI = [0.007565342
0.073514312
0.082089491
0.002417135
0.106824857
0.083978249
0.003170814
0.035543882
0.017051566
0.003302663
0.11747078
0.849382025
0.117940602
0.031821936
0.178663775
0.052651999
0.179643942
0.045145223
0.107784352
0.108876383
0.100431419
0.130865329
0.044562837
0.011254709
0.118935584
0.018146003
0.013989877
0.060739843
0
0.111112616
0.087009829
0.199674581
0.299244989
0.394858263
0.119043985
0.429684717
0.476455625
1
0.565680741
0.109009345
0.008377542
]; 

n = length(PI); % Number of transmission lines

% Handle NaN values by assigning them the highest rank (rank 1)
PI(isnan(PI)) = 1;
FRI(isnan(FRI)) = 1;

inputData = [PI, FRI];


% Load the FIS
fis = readfis('dist_tri_Alvarez_3x5_v2.fis');

% Evaluate the FIS
AVI_FIS = evalfis(fis, inputData);

% Display the output
disp(AVI_FIS);

% Sort the transmission lines based on aggregated Fuzzy scores
[~, AVI_FIS_ranking] = sort(AVI_FIS, 'descend');


disp(AVI_FIS_ranking);


% Plot
%%-------------------------------------------------------------------------------------------------

% Assuming AVI_FIS and AVI_FIS_ranking are already calculated

% Define the line names


line_name = {'L{1,2}', 'L{1,3}', 'L{2,4}', 'L{3,4}', 'L{2,5}', 'L{2,6}', 'L{4,6}', ...
        'L{5,7}', 'L{6,7}', 'L{6,8}', 'L{6,9}', 'L{6,10}', 'L{9,11}', 'L{9,10}', ...
        'L{4,12}', 'L{12,13}', 'L{12,14}', 'L{12,15}', 'L{12,16}', 'L{14,15}', ...
        'L{16,17}', 'L{15,18}', 'L{18,19}', 'L{19,20}', 'L{10,20}', 'L{10,17}', ...
        'L{10,21}', 'L{10,22}', 'L{21,22}', 'L{15,23}', 'L{22,24}', 'L{23,24}', ...
        'L{24,25}', 'L{25,26}', 'L{25,27}', 'L{28,27}', 'L{27,29}', 'L{27,30}', ...
        'L{29,30}', 'L{8,28}', 'L{6,28}'};

% Sort AVI_FIS values based on the ranking
sorted_AVI_FIS = AVI_FIS(AVI_FIS_ranking);

% Get the sorted line names based on the ranking
sorted_line_names = line_name(AVI_FIS_ranking);

% Create a bar plot

% Plotting the results

fig = figure;
fig.MenuBar = 'none'; % Remove the menu bar
fig.ToolBar = 'none'; % Remove the toolbar


bar_handle = bar(sorted_AVI_FIS);
bar_handle.BarWidth = 0.5;

% Customize the plot
%title('Fuzzy Inference System Evaluation Scores', 'FontSize', 14);
xlabel('Line', 'FontSize', 18);
ylabel('AVI', 'FontSize', 18);

% Set the x-axis tick labels to show the sorted line names
ax = gca;
ax.XTick = 1:length(sorted_line_names);
ax.XTickLabel = sorted_line_names;
ax.XAxis.FontSize = 18; % Increase the font size for the x-axis
ax.YAxis.FontSize = 18; % Increase the font size for the y-axis
xtickangle(90); % Rotate x-axis labels for better visibility

% Adjust the figure size to accommodate the stretched plot
fig = gcf;
fig.Position = [100, 100, 2000, 600]; % Modify the size of the figure as desired, last two are size aspect related

% Show the grid
grid on;

% Specify the directory and file name
directory = 'C:\Users\Saad Ullah Khan\Downloads\MSEE_Sajid\Paper\Sajid-Paper-V4\Figures\'; % Replace with your desired directory
filename = 'IEEE30_FIS_ranking_v2_MatP.png';

% Save the figure as a PNG image

exportgraphics(fig, fullfile(directory, filename), 'Resolution', 300);





