clc
clear 
close all


% data for PI and FRI 
PI = [0.212203649
0.288038799
0.708842063
0.29945922
0
0.069595922
0.17906456
0.256684725
0.066069297
0.035467555
0.39270404
0.16638005
0.539703573
NaN
1
0.041694438
0.111320244
0.172074887
0.045102692
0.210147627
]; 

FRI = [0.005649236
0.156413279
0.122339445
0.095287202
0.093148244
0.089770958
0
0.136424605
1
0.200895205
0.123649278
0.207747457
0.049366993
0.095496006
0.033708191
0.017599402
0.232870045
0.114323958
0.124845412
0.393092873
]; 

n = length(PI); % Number of transmission lines

% Handle NaN values by assigning them the highest rank (rank 1)
PI(isnan(PI)) = 1;
FRI(isnan(FRI)) = 1;

inputData = [PI, FRI];


% Load the FIS
fis = readfis('dist_tri_Alvarez_3x5_v2.fis');

% Evaluate the FIS
AVI_FIS = evalfis(fis, inputData);

% Display the output
disp(AVI_FIS);

% Sort the transmission lines based on aggregated Fuzzy scores
[~, AVI_FIS_ranking] = sort(AVI_FIS, 'descend');


disp(AVI_FIS_ranking);

